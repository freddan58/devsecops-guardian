{
  "agent_name": "DevSecOps Guardian - Analyzer Agent",
  "version": "1.0.0",
  "timestamp": "2026-02-17T22:01:19.459661+00:00",
  "repository": "freddan58/devsecops-guardian",
  "scanner_report": "C:\\Users\\furbano\\source\\repos\\devsecops-guardian\\agents\\analyzer\\..\\scanner\\reports\\scanner-output.json",
  "total_findings": 6,
  "confirmed_count": 6,
  "false_positive_count": 0,
  "findings": [
    {
      "anlz_id": "ANLZ-001",
      "scan_id": "SCAN-001",
      "verdict": "CONFIRMED",
      "exploitability_score": 95,
      "file": "demo-app/routes/accounts.js",
      "line": 14,
      "vulnerability": "SQL Injection",
      "cwe": "CWE-89",
      "severity": "CRITICAL",
      "description": "User input from query parameter 'id' is concatenated directly into SQL query without parameterization, allowing attackers to inject arbitrary SQL.",
      "evidence": "const query = `SELECT id, account_number, owner_name, balance, account_type \n                   FROM accounts WHERE id = ${id}`;",
      "recommendation": "Use parameterized queries: db.prepare('SELECT id, account_number, owner_name, balance, account_type FROM accounts WHERE id = ?').all(id)",
      "auth_context": "PUBLIC - no authentication middleware on GET /api/accounts",
      "data_sensitivity": "HIGH - exposes account_number, owner_name, balance (PCI and PII data)",
      "attack_scenario": "Attacker sends GET /api/accounts?id=1 OR 1=1 to inject SQL and retrieve all accounts including sensitive financial data",
      "false_positive_reason": null,
      "confirmed_evidence": "const query = `SELECT id, account_number, owner_name, balance, account_type \n                   FROM accounts WHERE id = ${id}`;"
    },
    {
      "anlz_id": "ANLZ-002",
      "scan_id": "SCAN-002",
      "verdict": "CONFIRMED",
      "exploitability_score": 80,
      "file": "demo-app/routes/search.js",
      "line": 19,
      "vulnerability": "Reflected Cross-Site Scripting (XSS)",
      "cwe": "CWE-79",
      "severity": "MEDIUM",
      "description": "User input from query parameter 'q' is reflected directly in HTML response without proper encoding or sanitization, enabling XSS attacks.",
      "evidence": "const html = `\n      <html>\n        <head><title>Search Results</title></head>\n        <body>\n          <h1>Search Results for: ${q}</h1>\n          <p>Found ${results.length} results</p>\n          <ul>\n            ${results.map(r => `<li>${r.owner_name} - ${r.account_type}</li>`).join('')}\n          </ul>\n        </body>\n      </html>\n    `;",
      "recommendation": "Properly encode or sanitize user input before including it in HTML responses. Use templating engines with automatic escaping or libraries like DOMPurify.",
      "auth_context": "PUBLIC - no authentication middleware on GET /api/search",
      "data_sensitivity": "MEDIUM - exposes owner_name and account_type (PII)",
      "attack_scenario": "Attacker crafts a query parameter q with malicious script tags to execute arbitrary JavaScript in victim's browser via reflected XSS",
      "false_positive_reason": null,
      "confirmed_evidence": "const html = `\n      <html>\n        <head><title>Search Results</title></head>\n        <body>\n          <h1>Search Results for: ${q}</h1>\n          <p>Found ${results.length} results</p>\n          <ul>\n            ${results.map(r => `<li>${r.owner_name} - ${r.account_type}</li>`).join('')}\n          </ul>\n        </body>\n      </html>\n    `;"
    },
    {
      "anlz_id": "ANLZ-003",
      "scan_id": "SCAN-003",
      "verdict": "CONFIRMED",
      "exploitability_score": 90,
      "file": "demo-app/config/database.js",
      "line": 8,
      "vulnerability": "Hardcoded Secrets",
      "cwe": "CWE-798",
      "severity": "HIGH",
      "description": "API key, database secret, and encryption key are hardcoded directly in source code, risking exposure and unauthorized access.",
      "evidence": "const DB_CONFIG = {\n  API_KEY: 'sk-proj-abc123def456ghi789jkl012mno345pqr678stu901vwx234',\n  DB_SECRET: 'super_secret_database_password_2024',\n  ENCRYPTION_KEY: 'aes-256-key-do-not-share-1234567890abcdef'\n};",
      "recommendation": "Move secrets to environment variables or secure vault solutions and do not commit them to source code repositories.",
      "auth_context": "N/A - configuration file, not an endpoint",
      "data_sensitivity": "HIGH - hardcoded API key, DB secret, and encryption key (critical secrets)",
      "attack_scenario": "An attacker gaining access to source code repository or server files can extract secrets and compromise database and encryption confidentiality",
      "false_positive_reason": null,
      "confirmed_evidence": "const DB_CONFIG = {\n  API_KEY: 'sk-proj-abc123def456ghi789jkl012mno345pqr678stu901vwx234',\n  DB_SECRET: 'super_secret_database_password_2024',\n  ENCRYPTION_KEY: 'aes-256-key-do-not-share-1234567890abcdef'\n};"
    },
    {
      "anlz_id": "ANLZ-004",
      "scan_id": "SCAN-004",
      "verdict": "CONFIRMED",
      "exploitability_score": 85,
      "file": "demo-app/middleware/logger.js",
      "line": 9,
      "vulnerability": "Information Exposure in Logs",
      "cwe": "CWE-532",
      "severity": "HIGH",
      "description": "Sensitive Personally Identifiable Information (PII) such as account numbers, SSNs, and credit card numbers are logged in request headers, bodies, query parameters, and response bodies.",
      "evidence": "console.log(`[${timestamp}] Headers:`, JSON.stringify(req.headers));\nconsole.log(`[${timestamp}] Request Body:`, JSON.stringify(req.body));\nconsole.log(`[${timestamp}] Query Params:`, JSON.stringify(req.query));\nconsole.log(`[${timestamp}] Response [${res.statusCode}]:`, typeof body === 'string' ? body.substring(0, 500) : body);",
      "recommendation": "Avoid logging sensitive data. Mask or redact PII before logging. Implement logging policies that exclude sensitive information.",
      "auth_context": "Middleware applied globally - logs all requests and responses including sensitive data",
      "data_sensitivity": "HIGH - logs PII including account numbers, SSNs, credit card numbers in headers, bodies, query params, and responses",
      "attack_scenario": "An attacker with access to logs can harvest sensitive PII and PCI data, leading to privacy violations and fraud",
      "false_positive_reason": null,
      "confirmed_evidence": "console.log(`[${timestamp}] Headers:`, JSON.stringify(req.headers));\nconsole.log(`[${timestamp}] Request Body:`, JSON.stringify(req.body));\nconsole.log(`[${timestamp}] Query Params:`, JSON.stringify(req.query));\nconsole.log(`[${timestamp}] Response [${res.statusCode}]:`, typeof body === 'string' ? body.substring(0, 500) : body);"
    },
    {
      "anlz_id": "ANLZ-005",
      "scan_id": "SCAN-005",
      "verdict": "CONFIRMED",
      "exploitability_score": 80,
      "file": "demo-app/routes/transfers.js",
      "line": 53,
      "vulnerability": "Missing Authorization / IDOR",
      "cwe": "CWE-639",
      "severity": "HIGH",
      "description": "Authenticated users can access transfer details by ID without verifying ownership, allowing unauthorized access to other users' transfers.",
      "evidence": "const transfer = db.prepare(\n      `SELECT t.*, a1.account_number as from_account, a2.account_number as to_account\n       FROM transfers t\n       JOIN accounts a1 ON t.from_account_id = a1.id\n       JOIN accounts a2 ON t.to_account_id = a2.id\n       WHERE t.id = ?`\n    ).get(id);\n\n// Missing: if (transfer.user_id !== req.user.id) return 403",
      "recommendation": "Add ownership check: verify that transfer.user_id matches req.user.id before returning transfer details.",
      "auth_context": "PROTECTED - authenticateToken middleware applied on GET /api/transfers/:id",
      "data_sensitivity": "HIGH - exposes transfer details including account numbers and amounts (PCI and PII)",
      "attack_scenario": "Authenticated user can access any transfer by ID without ownership check, allowing unauthorized viewing of other users' transfers",
      "false_positive_reason": null,
      "confirmed_evidence": "const transfer = db.prepare(\n      `SELECT t.*, a1.account_number as from_account, a2.account_number as to_account\n       FROM transfers t\n       JOIN accounts a1 ON t.from_account_id = a1.id\n       JOIN accounts a2 ON t.to_account_id = a2.id\n       WHERE t.id = ?`\n    ).get(id);\n\n// Missing: if (transfer.user_id !== req.user.id) return 403"
    },
    {
      "anlz_id": "ANLZ-006",
      "scan_id": "SCAN-006",
      "verdict": "CONFIRMED",
      "exploitability_score": 95,
      "file": "demo-app/routes/users.js",
      "line": 49,
      "vulnerability": "Missing Authentication",
      "cwe": "CWE-862",
      "severity": "CRITICAL",
      "description": "DELETE /api/users/:id endpoint lacks authentication middleware, allowing any unauthenticated user to delete any user account.",
      "evidence": "router.delete('/:id', (req, res) => {\n  const { id } = req.params;\n\n  try {\n    const db = getDatabase();\n    const result = db.prepare('DELETE FROM users WHERE id = ?').run(id);\n\n    if (result.changes === 0) {\n      return res.status(404).json({ error: 'User not found' });\n    }\n\n    res.json({ message: `User ${id} deleted successfully` });\n  } catch (err) {\n    res.status(500).json({ error: 'Delete error', details: err.message });\n  }\n});",
      "recommendation": "Protect this endpoint with authentication middleware (e.g., authenticateToken) and implement authorization checks to ensure only authorized users can delete accounts.",
      "auth_context": "PUBLIC - DELETE /api/users/:id endpoint lacks authentication middleware",
      "data_sensitivity": "HIGH - allows deletion of user accounts (PII and authentication credentials)",
      "attack_scenario": "Unauthenticated attacker can delete any user account by sending DELETE request to /api/users/:id",
      "false_positive_reason": null,
      "confirmed_evidence": "router.delete('/:id', (req, res) => {\n  const { id } = req.params;\n\n  try {\n    const db = getDatabase();\n    const result = db.prepare('DELETE FROM users WHERE id = ?').run(id);\n\n    if (result.changes === 0) {\n      return res.status(404).json({ error: 'User not found' });\n    }\n\n    res.json({ message: `User ${id} deleted successfully` });\n  } catch (err) {\n    res.status(500).json({ error: 'Delete error', details: err.message });\n  }\n});"
    }
  ]
}